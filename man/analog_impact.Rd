% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analog_impact.R
\name{analog_impact}
\alias{analog_impact}
\title{Climate impact: nearest climate analogs within a geographic envelope}
\usage{
analog_impact(
  focal,
  ref,
  max_geog,
  k = 20,
  max_clim = NULL,
  coord_type = "auto",
  report_dist = TRUE,
  n_threads = NULL
)
}
\arguments{
\item{focal}{Data.frame, matrix, or SpatRaster containing focal locations
with columns \code{x}, \code{y}, and climate variables.}

\item{ref}{Data.frame, matrix, or SpatRaster containing reference locations.}

\item{max_geog}{Maximum allowable geographic distance in kilometers. Only
reference locations within \code{max_geog} km are considered.}

\item{k}{Number of nearest climate analogs to return for each focal
(default = 20).}

\item{max_clim}{Optional additional climate constraint (scalar or vector).
Useful for restricting comparisons to very similar climate neighborhoods.}

\item{coord_type}{One of \code{"auto"}, \code{"lonlat"}, or
\code{"projected"}. \code{"auto"} attempts to detect the appropriate mode.}

\item{report_dist}{Logical; if TRUE (default), include climate and geographic
distance columns in the output.}

\item{n_threads}{Number of parallel compute threads to use.}
}
\value{
A data.frame with one row per focal–analog pair, including:
  \itemize{
    \item \code{focal_index}, \code{analog_index}
    \item \code{focal_x}, \code{focal_y}, \code{analog_x}, \code{analog_y}
    \item \code{clim_dist}, \code{geog_dist} (if \code{report_dist = TRUE})
  }
Diagnostic attributes from the underlying spatial index are preserved.
}
\description{
Computes, for each focal location, the climate–nearest neighbor(s) in a
reference dataset that satisfy a specified geographic distance threshold.
This helper wraps \code{\link{find_analogs}} using \code{mode = "knn_clim"}.
}
\details{
It is useful for estimating the potential ecological impact of local climate
change: e.g., how climate conditions at a site compare to those available
within a species' dispersal range.


For each focal location, \code{impact()}:
\enumerate{
  \item Identifies all reference points within \code{max_geog} km (and
        optional climate filter).
  \item Selects the \code{k} closest in \emph{climate} distance.
}

This is the natural “inverse” of \code{\link{velocity}}: instead of finding
where the focal climate moves geographically, it finds the closest climatically
similar conditions that are geographically reachable.
}
\examples{
\dontrun{
im <- impact(
  focal = clim$clim1,
  ref   = clim$clim2,
  max_geog = 100,
  k = 20
)
}

}
